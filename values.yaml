global:
  env:
    # Postgres
    DB_HOST: "79.174.89.43"
    DB_PORT: "18809"
    DB_NAME: "team13_db"
    DB_USER: "team13"
    # RabbitMQ
    RABBIT_USER: "user"
    RABBIT_HOST: "rabbitmq"
    RABBIT_PORT: "5672"
    QUEUE_NAME: "article_queue" # ARTICLE_QUEUE_NAME
    # Redis
    REDIS_HOST: "redis"
    REDIS_PORT: "6379"
    # Auth
    ALGORITHM: "HS256"
    DB_PASS: ""
    RABBIT_PASS: ""
    SECRET_KEY: ""
    GEMINI_KEY: ""
    PROXY_URL: ""
imagePullSecrets:
  - name: ghcr-secret
ingress:
  enabled: true
  className: "nginx"
  host: "team-13.kubepractice.ru"
  tls:
    secretName: "team13-tls"
auth:
  image:
    repository: ghcr.io/csu-itmo-2025-2/team13-auth
    pullPolicy: Always
    tag: "sha-2022fe7"
  port: 5002
bff:
  image:
    repository: ghcr.io/csu-itmo-2025-2/team13-bff
    pullPolicy: Always
    tag: "sha-2022fe7"
  port: 8000
habr:
  image:
    repository: ghcr.io/csu-itmo-2025-2/team13-habr
    pullPolicy: Always
    tag: "sha-9d07a99"
  port: 5000
llm:
  image:
    repository: ghcr.io/csu-itmo-2025-2/team13-llm
    pullPolicy: Always
    tag: "sha-9d07a99"
  port: 5001
rabbitmq:
  image: rabbitmq:3.12-management
  port: 5672
  uiPort: 15672
  probes:
    startup:
      initialDelaySeconds: 60
      periodSeconds: 60
      timeoutSeconds: 30
      failureThreshold: 30
    readiness:
      initialDelaySeconds: 20
      periodSeconds: 60
      timeoutSeconds: 30
      failureThreshold: 3
    liveness:
      initialDelaySeconds: 60
      periodSeconds: 60
      timeoutSeconds: 30
      failureThreshold: 3
redis:
  image: redis:7-alpine
  port: 6379
keda:
  enabled: true
  llmConsumer:
    minReplicas: 1
    maxReplicas: 10
    queueLength: "5"  # Scale up when queue has more than 5 messages per replica
    pollingInterval: 10
    cooldownPeriod: 30
  habr:
    minReplicas: 1
    maxReplicas: 5
    cpuThreshold: "70"  # Scale up when CPU usage exceeds 70%
    memoryThreshold: "80"  # Scale up when memory usage exceeds 80%
    pollingInterval: 10
    cooldownPeriod: 30
probes:
  http:
    healthPath: "/health"  # Health check endpoint path
    startup:
      initialDelaySeconds: 10
      periodSeconds: 5
      timeoutSeconds: 3
      failureThreshold: 30
    readiness:
      initialDelaySeconds: 5
      periodSeconds: 5
      timeoutSeconds: 3
      failureThreshold: 3
    liveness:
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 3
      failureThreshold: 3
  exec:
    startup:
      initialDelaySeconds: 10
      periodSeconds: 5
      timeoutSeconds: 3
      failureThreshold: 30
    readiness:
      initialDelaySeconds: 5
      periodSeconds: 5
      timeoutSeconds: 3
      failureThreshold: 3
    liveness:
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 3
      failureThreshold: 3
